<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="16-Week Trainer">
    <title>16-Week Trainer</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* Mobile Optimizations */
        body {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            user-select: none;
            background-color: #000;
            /* Safe area for iPhone Notch */
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        /* Prevent auto-zoom on inputs */
        input {
            font-size: 16px !important; 
        }

        /* Hide Scrollbar */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-in {
            animation: fadeIn 0.3s ease-out forwards;
        }
    </style>
</head>
<body class="bg-black text-white min-h-screen font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS (SVG) ---
        // Simple inline SVG components to replace Lucide
        const Icon = ({ path, size = 24, className = "" }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {path}
            </svg>
        );

        const Icons = {
            Play: (props) => <Icon path={<polygon points="5 3 19 12 5 21 5 3"></polygon>} {...props} />,
            Pause: (props) => <Icon path={<><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></>} {...props} />,
            CheckCircle: (props) => <Icon path={<><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></>} {...props} />,
            Clock: (props) => <Icon path={<><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></>} {...props} />,
            Trophy: (props) => <Icon path={<><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path><path d="M4 22h16"></path><path d="M12 15a7 7 0 0 0 7-7V2H5v6a7 7 0 0 0 7 7z"></path><path d="M12 15v7"></path></>} {...props} />,
            ChevronRight: (props) => <Icon path={<polyline points="9 18 15 12 9 6"></polyline>} {...props} />,
            ArrowLeft: (props) => <Icon path={<><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></>} {...props} />,
            Calendar: (props) => <Icon path={<><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></>} {...props} />,
            Dumbbell: (props) => <Icon path={<><path d="M6.5 6.5l11 11"></path><path d="M21 21l-1-1"></path><path d="M3 3l1 1"></path><path d="M18 22l4-4"></path><path d="M2 6l4-4"></path><path d="M3 10l7-7"></path><path d="M14 21l7-7"></path></>} {...props} />,
            List: (props) => <Icon path={<><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></>} {...props} />
        };

        // --- DATA ---
        const PHASES = [
            {
                id: 1,
                name: "Foundation & Conditioning",
                weeks: [1, 2, 3, 4],
                description: "Rebuilding mind-muscle connection. Moderate weights.",
                restTime: 60,
                focus: "Form & Stability",
                schedule: ["Legs", "Chest & Triceps", "Rest", "Back & Biceps", "Shoulders & Abs", "Active Recovery", "Rest"]
            },
            {
                id: 2,
                name: "Hypertrophy (Growth)",
                weeks: [5, 6, 7, 8],
                description: "Volume increases. Classic muscle building.",
                restTime: 45,
                focus: "Volume & Squeeze",
                schedule: ["Legs & Calves", "Chest & Abs", "Back", "Rest", "Shoulders & Traps", "Arms (Bi/Tri)", "Rest"]
            },
            {
                id: 3,
                name: "Strength & Power",
                weeks: [9, 10, 11, 12],
                description: "Heavier weights, lower reps. Explode up.",
                restTime: 90,
                focus: "Heavy Compounds",
                schedule: ["Legs (Heavy)", "Push", "Pull", "Rest", "Legs (Volume)", "Upper Body Shock", "Rest"]
            },
            {
                id: 4,
                name: "Shred & Definition",
                weeks: [13, 14, 15, 16],
                description: "High intensity, supersets to burn fat.",
                restTime: 30,
                focus: "Intensity",
                schedule: ["Legs", "Chest & Back", "Rest", "Shoulders & Arms", "Full Body Circuit", "Cardio 45m", "Rest"]
            }
        ];

        const EXERCISE_LIBRARY = {
            "Legs": [
                { name: "Leg Press", sets: 3, reps: "12-15" },
                { name: "Goblet Squats", sets: 3, reps: "12-15" },
                { name: "Walking Lunges", sets: 3, reps: "20 steps" },
                { name: "Lying Leg Curls", sets: 3, reps: "15" },
                { name: "Standing Calf Raises", sets: 4, reps: "20" }
            ],
            "Chest & Triceps": [
                { name: "Incline Dumbbell Press", sets: 3, reps: "12-15" },
                { name: "Flat Machine Press", sets: 3, reps: "12-15" },
                { name: "Cable Flyes", sets: 3, reps: "15" },
                { name: "Tricep Rope Pushdowns", sets: 3, reps: "15" },
                { name: "Overhead Dumbbell Ext", sets: 3, reps: "12-15" }
            ],
            "Back & Biceps": [
                { name: "Lat Pulldowns (Wide)", sets: 3, reps: "12-15" },
                { name: "Seated Cable Rows", sets: 3, reps: "12-15" },
                { name: "Face Pulls", sets: 3, reps: "15" },
                { name: "Hyperextensions", sets: 3, reps: "15" },
                { name: "Standing Barbell Curls", sets: 3, reps: "12-15" },
                { name: "Hammer Curls", sets: 3, reps: "12-15" }
            ],
            "Shoulders & Abs": [
                { name: "Seated Dumbbell Press", sets: 3, reps: "12-15" },
                { name: "Lateral Raises", sets: 3, reps: "15-20" },
                { name: "Front Plate Raises", sets: 3, reps: "15" },
                { name: "Plank", sets: 3, reps: "45 sec" },
                { name: "Crunches", sets: 3, reps: "20" }
            ]
        };

        const MACHINES_NEEDED = [
            "Dumbbells (5kg - 30kg+)",
            "Leg Press Machine",
            "Cable Station (Lat Pulldown/Row)",
            "Adjustable Bench",
            "Leg Curl Machine",
            "Pull-up Bar / Assist Machine",
            "Barbell & Plates",
            "Treadmill / Cardio Machine"
        ];

        // --- COMPONENTS ---

        const Card = ({ children, className = "" }) => (
            <div className={`bg-gray-800 rounded-xl border border-gray-700 shadow-lg ${className}`}>
                {children}
            </div>
        );

        const Button = ({ onClick, variant = "primary", className = "", children, disabled = false }) => {
            const variants = {
                primary: "bg-blue-600 active:bg-blue-700 text-white",
                secondary: "bg-gray-700 active:bg-gray-600 text-gray-200",
                danger: "bg-red-600 active:bg-red-700 text-white",
                success: "bg-green-600 active:bg-green-700 text-white",
            };
            return (
                <button 
                    onClick={onClick}
                    disabled={disabled}
                    className={`px-4 py-3 rounded-lg font-semibold transition-transform active:scale-95 flex items-center justify-center gap-2 ${variants[variant]} ${className} ${disabled ? 'opacity-50' : ''}`}
                >
                    {children}
                </button>
            );
        };

        // --- MAIN APP ---

        function WorkoutApp() {
            const [view, setView] = useState("dashboard");
            const [activeWeek, setActiveWeek] = useState(1);
            const [activeDay, setActiveDay] = useState(1);
            const [currentPhase, setCurrentPhase] = useState(PHASES[0]);
            
            // Tracking
            const [sessionActive, setSessionActive] = useState(false);
            const [sessionTime, setSessionTime] = useState(0);
            const [sessionPaused, setSessionPaused] = useState(false);
            const [completedSets, setCompletedSets] = useState({});
            const [restTimer, setRestTimer] = useState(0);
            const [restActive, setRestActive] = useState(false);
            
            const timerRef = useRef(null);
            const restTimerRef = useRef(null);

            useEffect(() => {
                const phase = PHASES.find(p => p.weeks.includes(activeWeek));
                if (phase) setCurrentPhase(phase);
            }, [activeWeek]);

            useEffect(() => {
                if (sessionActive && !sessionPaused) {
                    timerRef.current = setInterval(() => setSessionTime(p => p + 1), 1000);
                } else {
                    clearInterval(timerRef.current);
                }
                return () => clearInterval(timerRef.current);
            }, [sessionActive, sessionPaused]);

            useEffect(() => {
                if (restActive && restTimer > 0) {
                    restTimerRef.current = setInterval(() => setRestTimer(p => p - 1), 1000);
                } else if (restTimer === 0) {
                    setRestActive(false);
                    clearInterval(restTimerRef.current);
                }
                return () => clearInterval(restTimerRef.current);
            }, [restActive, restTimer]);

            const formatTime = (s) => {
                const m = Math.floor(s / 60);
                const sc = s % 60;
                return `${m}:${sc < 10 ? '0' : ''}${sc}`;
            };

            const getDayName = (d) => ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"][d - 1];

            const getWorkoutForDay = (phase, dayNum) => {
                const name = phase.schedule[dayNum - 1];
                if (name.includes("Rest")) return null;
                if (name.includes("Active")) return { type: "cardio", title: "Active Recovery", exercises: [] };
                if (name.includes("Cardio")) return { type: "cardio", title: "Cardio", exercises: [] };
                
                // Fallback logic for demo
                let exercises = EXERCISE_LIBRARY["Legs"];
                if (name.includes("Chest") || name.includes("Push")) exercises = EXERCISE_LIBRARY["Chest & Triceps"];
                if (name.includes("Back") || name.includes("Pull")) exercises = EXERCISE_LIBRARY["Back & Biceps"];
                if (name.includes("Shoulders")) exercises = EXERCISE_LIBRARY["Shoulders & Abs"];
                
                return { type: "lift", title: name, exercises };
            };

            const currentWorkout = getWorkoutForDay(currentPhase, activeDay);

            const toggleSetComplete = (exIdx, setIdx, weight) => {
                const key = `${exIdx}-${setIdx}`;
                if (!completedSets[key]) {
                    setCompletedSets(p => ({ ...p, [key]: weight || "BW" }));
                    setRestTimer(currentPhase.restTime);
                    setRestActive(true);
                } else {
                    const newSets = { ...completedSets };
                    delete newSets[key];
                    setCompletedSets(newSets);
                    setRestActive(false);
                }
            };

            const renderOverview = () => (
                <div className="space-y-6 pb-24 pt-4 px-4 animate-in">
                    <div className="flex items-center gap-4 mb-2">
                         <button onClick={() => setView("dashboard")} className="bg-gray-800 p-2 rounded-full active:scale-95 transition-transform"><Icons.ArrowLeft size={20} /></button>
                         <h1 className="text-2xl font-bold">Program Overview</h1>
                    </div>

                    <Card className="p-4 border-l-4 border-l-blue-500">
                        <h3 className="text-lg font-bold text-blue-400 mb-3 flex items-center gap-2">
                            <Icons.Dumbbell size={20} /> Gym Equipment Needed
                        </h3>
                        <div className="grid grid-cols-1 gap-2 text-sm text-gray-300">
                            {MACHINES_NEEDED.map((m, i) => (
                                <div key={i} className="flex items-center gap-3">
                                    <div className="w-1.5 h-1.5 bg-blue-500 rounded-full"></div> 
                                    {m}
                                </div>
                            ))}
                        </div>
                    </Card>

                    <div className="space-y-6">
                        {PHASES.map(phase => (
                            <div key={phase.id} className="relative pl-6 py-1">
                                <div className="absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-blue-600 to-blue-900 rounded-full"></div>
                                <h3 className="text-xl font-bold text-white">{phase.name}</h3>
                                <div className="flex items-center gap-2 mb-2">
                                    <span className="text-xs bg-blue-900 text-blue-100 px-2 py-0.5 rounded">Weeks {phase.weeks[0]}-{phase.weeks[phase.weeks.length-1]}</span>
                                    <span className="text-xs text-gray-500">{phase.focus}</span>
                                </div>
                                <p className="text-sm text-gray-400 italic mb-3">"{phase.description}"</p>
                                <div className="space-y-1 bg-gray-800/50 p-3 rounded-lg border border-gray-700/50">
                                    {phase.schedule.map((day, i) => (
                                         <div key={i} className="text-sm text-gray-300 flex justify-between border-b border-gray-700/50 last:border-0 py-1">
                                            <span className="text-gray-500 w-12">Day {i+1}</span>
                                            <span className={`font-medium ${day.includes('Rest') ? 'text-gray-600' : 'text-blue-200'}`}>{day}</span>
                                         </div>
                                    ))}
                                </div>
                            </div>
                        ))}
                    </div>
                    
                    <Button onClick={() => setView("dashboard")} variant="secondary" className="w-full mt-8">
                        Back to Dashboard
                    </Button>
                </div>
            );

            const renderDashboard = () => (
                <div className="space-y-6 pb-24 pt-4 px-4 animate-in">
                    <div className="flex items-center justify-between bg-gradient-to-r from-blue-900 to-gray-900 p-6 rounded-2xl shadow-xl">
                        <div>
                            <h1 className="text-2xl font-bold text-white">Welcome Back</h1>
                            <p className="text-blue-200 text-sm mt-1">Week {activeWeek} â€¢ {currentPhase.name}</p>
                        </div>
                        <div className="h-10 w-10 bg-blue-600 rounded-full flex items-center justify-center font-bold">40</div>
                    </div>

                    <Button 
                        variant="secondary" 
                        onClick={() => setView("overview")}
                        className="w-full bg-gray-800 border border-gray-700 hover:bg-gray-700"
                    >
                        <Icons.List size={18} /> View Full Program & Machines
                    </Button>

                    <div className="flex overflow-x-auto pb-2 gap-2 no-scrollbar">
                        {Array.from({length: 16}, (_, i) => i + 1).map(w => (
                            <button 
                                key={w} 
                                onClick={() => setActiveWeek(w)}
                                className={`flex-shrink-0 w-12 h-12 rounded-lg font-bold ${activeWeek === w ? 'bg-blue-600 text-white' : 'bg-gray-800 text-gray-500'}`}
                            >
                                {w}
                            </button>
                        ))}
                    </div>

                    <div className="space-y-3">
                        <h3 className="text-lg font-bold flex items-center gap-2"><Icons.Calendar size={18} /> Week {activeWeek} Schedule</h3>
                        {currentPhase.schedule.map((name, i) => {
                            const d = i + 1;
                            const isToday = activeDay === d;
                            return (
                                <div key={i} onClick={() => setActiveDay(d)} 
                                    className={`p-4 rounded-xl border flex items-center justify-between cursor-pointer ${isToday ? 'bg-blue-900/30 border-blue-500 ring-1 ring-blue-500' : 'bg-gray-800 border-gray-700'}`}>
                                    <div className="flex items-center gap-4">
                                        <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs ${isToday ? 'bg-blue-600' : 'bg-gray-700 text-gray-400'}`}>
                                            {getDayName(d).substring(0,3)}
                                        </div>
                                        <div>
                                            <p className={`font-semibold ${isToday ? 'text-white' : 'text-gray-300'}`}>{name}</p>
                                        </div>
                                    </div>
                                    {isToday && !name.includes("Rest") && <Icons.ChevronRight className="text-blue-500" />}
                                </div>
                            );
                        })}
                    </div>

                    {currentWorkout && currentWorkout.type === 'lift' && (
                        <div className="fixed bottom-0 left-0 right-0 p-4 pb-8 bg-gradient-to-t from-black via-black to-transparent">
                            <Button onClick={() => {
                                setSessionActive(true);
                                setSessionPaused(false);
                                setSessionTime(0);
                                setCompletedSets({});
                                setView("workout");
                            }} className="w-full py-4 text-lg shadow-blue-900/50 shadow-lg">
                                Start Workout <Icons.Play size={20} fill="currentColor" />
                            </Button>
                        </div>
                    )}
                </div>
            );

            const renderWorkout = () => {
                const progress = (Object.keys(completedSets).length / (currentWorkout.exercises.reduce((acc, ex) => acc + ex.sets, 0))) * 100;
                
                return (
                    <div className="h-full flex flex-col relative pb-24 animate-in">
                        <div className="sticky top-0 bg-gray-900/95 backdrop-blur z-20 px-4 py-3 border-b border-gray-800 flex justify-between items-center">
                            <div>
                                <h2 className="text-xs text-gray-400 font-bold uppercase">{getDayName(activeDay)}</h2>
                                <h1 className="text-lg font-bold leading-none">{currentWorkout.title}</h1>
                            </div>
                            <div className="font-mono text-xl font-bold text-blue-400">{formatTime(sessionTime)}</div>
                        </div>

                        <div className="h-1 bg-gray-800 w-full"><div className="h-full bg-blue-500 transition-all duration-300" style={{width: `${progress}%`}}></div></div>

                        <div className="flex-1 overflow-y-auto p-4 space-y-8">
                            {currentWorkout.exercises.map((ex, exIdx) => (
                                <div key={exIdx}>
                                    <div className="flex justify-between items-center mb-2">
                                        <h3 className="font-bold text-lg">{ex.name}</h3>
                                        <span className="text-xs bg-gray-800 px-2 py-1 rounded text-gray-400">{ex.reps} reps</span>
                                    </div>
                                    <div className="space-y-2">
                                        {Array.from({length: ex.sets}).map((_, setIdx) => {
                                            const key = `${exIdx}-${setIdx}`;
                                            const isDone = !!completedSets[key];
                                            return (
                                                <div key={setIdx} className={`flex items-center gap-3 p-3 rounded-lg border ${isDone ? 'bg-green-900/20 border-green-800' : 'bg-gray-800 border-gray-700'}`}>
                                                    <span className="text-gray-500 font-mono text-sm w-4">{setIdx + 1}</span>
                                                    <input type="number" placeholder="kg" disabled={isDone} className="w-20 bg-gray-900 border border-gray-600 rounded p-2 text-center focus:border-blue-500 outline-none" />
                                                    <div className="flex-1"></div>
                                                    <button onClick={() => toggleSetComplete(exIdx, setIdx, 50)} 
                                                        className={`h-10 w-10 rounded-full flex items-center justify-center transition-all ${isDone ? 'bg-green-500 text-white' : 'bg-gray-700 text-gray-400'}`}>
                                                        {isDone ? <Icons.CheckCircle size={20} /> : <div className="w-4 h-4 rounded-full border-2 border-gray-400"></div>}
                                                    </button>
                                                </div>
                                            )
                                        })}
                                    </div>
                                </div>
                            ))}
                        </div>

                        <div className="fixed bottom-0 left-0 right-0 bg-gray-900 border-t border-gray-800 p-4 pb-8 z-30 flex gap-3">
                            <button onClick={() => setSessionPaused(!sessionPaused)} className="flex-1 bg-gray-800 text-white font-bold py-3 rounded-lg border border-gray-600 flex justify-center items-center gap-2">
                                {sessionPaused ? <><Icons.Play size={18} /> Resume</> : <><Icons.Pause size={18} /> Pause</>}
                            </button>
                            <Button onClick={() => { setSessionActive(false); setView("summary"); }} variant="danger" className="flex-1">Finish</Button>
                        </div>

                        {restActive && (
                            <div className="fixed inset-0 bg-black/90 z-50 flex flex-col items-center justify-center animate-in backdrop-blur-sm">
                                <div className="text-gray-400 font-bold uppercase tracking-widest mb-4">Rest</div>
                                <div className="text-8xl font-black text-blue-500 font-mono mb-8">{restTimer}</div>
                                <div className="flex gap-4">
                                    <Button onClick={() => setRestTimer(p => p + 10)} variant="secondary">+10s</Button>
                                    <Button onClick={() => setRestActive(false)} variant="primary">Skip</Button>
                                </div>
                            </div>
                        )}
                    </div>
                );
            };

            const renderSummary = () => (
                <div className="flex flex-col items-center justify-center h-full px-4 text-center animate-in space-y-8">
                    <div className="w-24 h-24 bg-green-500 rounded-full flex items-center justify-center shadow-lg shadow-green-900/50 text-white">
                        <Icons.Trophy size={48} />
                    </div>
                    <div>
                        <h2 className="text-3xl font-bold text-white">Workout Complete!</h2>
                        <p className="text-gray-400 mt-2">Rest up for tomorrow.</p>
                    </div>
                    <div className="w-full max-w-xs bg-gray-800 p-6 rounded-xl border border-gray-700">
                        <div className="flex justify-between items-center mb-4 pb-4 border-b border-gray-700">
                            <span className="text-gray-400">Time</span>
                            <span className="font-bold text-xl">{formatTime(sessionTime)}</span>
                        </div>
                        <div className="flex justify-between items-center">
                            <span className="text-gray-400">Sets</span>
                            <span className="font-bold text-xl">{Object.keys(completedSets).length}</span>
                        </div>
                    </div>
                    <Button onClick={() => setView("dashboard")} className="w-full max-w-xs py-4">Back to Dashboard</Button>
                </div>
            );

            return (
                <div className="max-w-md mx-auto min-h-screen bg-gray-900 shadow-2xl relative overflow-hidden flex flex-col">
                    {view === "dashboard" && renderDashboard()}
                    {view === "overview" && renderOverview()}
                    {view === "workout" && renderWorkout()}
                    {view === "summary" && renderSummary()}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<WorkoutApp />);
    </script>
</body>
</html>